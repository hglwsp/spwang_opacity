import numpy as np
import matplotlib.pyplot as plt
import math
import random
#import tensorflow as tf
from sympy import *
import sympy as sp
import torch
import torch.nn as nn

x1 = symbols("x1")  # 符号x，自变量
x2 = symbols("x2")
x3 = symbols("x3")
x4 = symbols("x4")
x5 = symbols("x5")
x6 = symbols("x6")
x7 = symbols("x7")



z = symbols("relu")
z1 = symbols("hardtanh")

# y = 0.792*pow(x1-1,2)#公式
# apart(y,x1)



w1=np.array([
    [-0.32589011511459415, 0.21315876881274579, 0.3550829317234852, 0.07979642903508014, 0.48182070025425955,
     1.6523358888580557, -1.1103869169278275],
    [-0.4691717246565489, -1.228651398388537, -0.5584097755284388, 0.5792058532627531, -0.5524731121472444,
     0.846101390583569, -2.221886537757828],
    [0.07614807072051859, 0.09845249225445776, 1.3915146188535996, 1.138017488603008, 1.2941163693490645,
     -1.5416352253052799, -0.5153231392662057],
    [-1.4556321910415029, -0.352980668928574, -1.1314664839190143, 0.017019600990757597, 0.5564604540641268,
     0.30237570909313566, 0.12236354470134629],
    [-0.20215964268281547, -0.13792151635171793, -0.41652942744033666, 0.44874153998233135, -0.8705111372016399,
     0.13509970225513565, -0.5954101951257018],
    [0.3976649993439029, -0.1631043589656781, -0.008067544771251668, 2.4567441114659663, 0.003379180728264315,
     -0.1930685579783838, -1.0884014835389064],
    [-1.0704088453133465, -0.31093187129597677, 1.1605645451684374, -1.9473963072445384, 0.6246320195583207,
     0.12365042187939634, -1.5856538498228983],
    [0.39623161042776445, -0.49277643047910885, 2.1465367444432992, -0.9393491317156302, 0.349835809333761,
     -0.525778407638624, -1.7473786517173597]
]).T
b1= \
    [-0.911562144988182, -0.8915547270568551, -0.7891745246799469, 0.025594342506372984, 0.43288518086165406,
     -1.397917109380136, -0.26853749854624087, -1.39977308952442]
expr1 = z * (np.matmul([[x1,x2,x3,x4,x5,x6,x7]],w1)+b1)
#expr1 = -0.0001711589065517019 *pow(expr1,4)+ -0.01447711943585072 *pow(expr1,3)+ 0.002849795794085815 *pow(expr1,2)+ 0.5071116596907747 *expr1+ -0.00508383030596129
# expr1_1 = 0.25 * expr1 * expr1 + 0.001
# expr1 = 0.5 * expr1 + pow(expr1_1,0.5)

w2 =np.array(
[0.028858004205527983, 0.9877309333739801, 0.03255370911667595, 0.09161557100427509, 0.0018854110404350624, 0.0027847832092398462, -0.07998865874598397, 0.0004538463195408843]
).T
b2=   [-0.04700730282568325]

expr2 =  np.matmul(expr1,w2)+b2
print(expr2)
# expr3 = simplify(expr2)
# print(expr3)