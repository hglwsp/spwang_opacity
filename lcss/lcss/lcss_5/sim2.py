import numpy as np
from sympy import *


x1 = symbols("x1")  # 符号x，自变量
x2 = symbols("x2")
x3 = symbols("x3")
x4 = symbols("x4")


z = symbols("relu")

# y = 0.792*pow(x1-1,2)#公式
# apart(y,x1)



w1=np.array([[1.115952058595115, 0.047035043696643415, 0.38681499777444284, -0.3094650466012764],
[0.9373002528847773, 0.25289621246787025, 0.24359506243503415, 0.5591308872703558],
[-0.13242470338731605, -1.7494158509455646, 0.6216635113251935, 1.7082264898012038],
[1.2832498608743148, 0.8167511374182878, -0.3867620444125762, -1.1134997243057645],
[-3.653684532164571, 0.3312982943617407, 0.7899873444611071, -0.5985076101847946],
[0.08413820312344714, -1.1504307665796711, -0.2251692649182369, -0.9948624127369156],
[-1.3063190838391625, 0.48787735481553696, -0.4254584125199654, 0.9331527525116543],
[0.052503587316000515, -0.07503759164370574, 1.2509358854434038, 0.4332965845192416],
[2.0724828448525114, -0.4737120971505582, 0.23008172746319155, 0.05988803892075537],
[1.1486621744481251, -0.19175281660483107, 0.8330626227962135, 1.3027002902301708]
    ]).T
b1=[-0.021214435922837022, -1.7132648326518063, 0.890510557683113, 1.458270203138792, -0.1253883792897218, -0.5669599831449794, -0.5026903536512107, -0.06317359818766853, -1.2288061243967088, -0.8913087976758668]

expr1 = z * (np.matmul([[x1,x2,x3,x4]],w1)+b1)
#expr1 = -0.0001711589065517019 *pow(expr1,4)+ -0.01447711943585072 *pow(expr1,3)+ 0.002849795794085815 *pow(expr1,2)+ 0.5071116596907747 *expr1+ -0.00508383030596129
# expr1_1 = 0.25 * expr1 * expr1 + 0.001
# expr1 = 0.5 * expr1 + pow(expr1_1,0.5)


w2 =np.array([-0.7824144844808802, -0.4555828935593847, 0.3609695329957612, 0.4338056997645676, 0.5172656480567158, -0.5348185905545801, -0.23457058690087706, -0.8294888274492466, 0.5777823638450426, -0.27078967275766247]).T
b2=[-0.9038557709211413]

expr2=np.matmul(expr1,w2)+b2
print(expr2)
# expr3 = simplify(expr2)
# print(expr3)