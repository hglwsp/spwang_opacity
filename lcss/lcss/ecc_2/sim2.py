import numpy as np
from sympy import *


x1 = symbols("x1")  # 符号x，自变量
x2 = symbols("x2")
x3 = symbols("x3")
x4 = symbols("x4")

# x1 = symbols("f_x1")  # 符号x，自变量
# x2 = symbols("f_x2")
# x3 = symbols("f_x3")
# x4 = symbols("f_x4")


z = symbols("relu")

# y = 0.792*pow(x1-1,2)#公式
# apart(y,x1)



w1=np.array([
[-0.5221931440575912, -0.24300331065060685, -0.8356208377388797, 0.37243819884264256],[ 1.2072953256232406, 1.0962113786434962, -0.2633476409370833, -0.96417708614709],[ 0.20336169959807424, 0.4474785576609537, -0.6143607148097696, -0.6963444237915618],[ 0.09394335713463221, 1.0131636915691544, 0.4633995485879803, -0.21845661454918372],[ -0.5635020536098456, -0.305833294937525, 1.5316091675290413, -0.6331146716311008],[ -0.8347299697898956, 1.2095318559064208, 2.2421646159347413, 0.6586948459107489],[ 0.7101366472646075, 1.5323054479792804, 0.06057299900530916, 1.3434401160142333],[ 0.3888884549690077, 0.5805911483221012, 0.758140156039916, -1.741671279110954],[ 1.8977584794455007, -0.03466133597835987, 0.31801538077045716, 1.1003749490091985],[ 0.2019824906322688, 1.1365745086270629, -0.029677999874005084, 1.0988949483848813],[ 0.4156725905194268, -0.9353866602689652, -0.34293111556493056, 0.8693787908003705],[ 0.14366649743703713, 0.16971323700631585, -1.1293636502085966, 1.2588218719735351],[ 1.08303850725281, 1.841304474173869, 0.30156028638226884, -1.638781190371691],[ -0.5580032496055357, 1.4030460032675858, -0.889214695912757, 0.06733278867792793],[ 0.13513492487733944, -0.3081969813933137, -0.5812285262818377, -1.2417222012196072],[ -1.3346131118859477, -1.0824058182707152, 0.7719190599381107, -0.7164083637295007]
]).T

b1=\
[-0.6658473182992201, 0.5174446720997882, -0.775895059168749, -1.6555837019723427, -0.8167482483910808, -0.11226898648346675, -0.4253050972276981, -0.17198464410321476, -0.15401894589294587, 2.0411589576426223, -0.011709568362224454, 0.1203738640675092, 0.6400968381550424, -0.11997111062021107, -0.8930426670070094, -1.3747123183344525]

expr1 = z * (np.matmul([[x1,x2,x3,x4]],w1)+b1)
#expr1 = -0.0001711589065517019 *pow(expr1,4)+ -0.01447711943585072 *pow(expr1,3)+ 0.002849795794085815 *pow(expr1,2)+ 0.5071116596907747 *expr1+ -0.00508383030596129
# expr1_1 = 0.25 * expr1 * expr1 + 0.001
# expr1 = 0.5 * expr1 + pow(expr1_1,0.5)


w2 =np.array(
[-0.8287656585282445, -0.16819622450451024, -0.9795826844998058, 0.9194262272974706, 1.151757303883165, -0.5067530312392485, -0.4504633153937348, 1.0027974652181018, -0.19556013746420042, 1.4713977444790323, 2.5340526992989734, -1.1826959845535678, -0.11474672019551777, 1.4418984924346323, 0.8778602724123469, 1.470862081176588]
).T
b2= [-2.816173125368255]

expr2=np.matmul(expr1,w2)+b2
print(expr2)
# expr3 = simplify(expr2)
# print(expr3)