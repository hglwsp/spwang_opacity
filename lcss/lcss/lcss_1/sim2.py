import numpy as np
from sympy import *


x1 = symbols("x1")  # 符号x，自变量
x2 = symbols("x2")
x3 = symbols("x3")
x4 = symbols("x4")


z = symbols("relu")

# y = 0.792*pow(x1-1,2)#公式
# apart(y,x1)



w1=np.array([
    [-1.8510860618382492, 0.7407393315379626, 1.9035962813007177, 2.5101695454329565],[ 0.9489031997133044, -1.063528652193766, 0.34857765326444395, -2.0315779272514862],[ 0.008813569239534849, 0.026567123756254096, 0.27982645510670606, -0.05760479981730231],[ -0.460476439365189, 0.40798972191386773, -1.6712872227068052, 1.043527498445102],[ 0.17911458369953656, -1.9478344214901915, -1.798646603144955, 1.4069159269350586],[ 3.0738865938965856, -3.2916083553929782, -1.8725001715649137, 5.86326181700328],[ -1.030462143955227, -0.9095554064088065, -1.3877059020045774, 0.0818228815161483],[ -0.4130085296118243, 0.2094145577049648, -1.1858079358363618, 2.1209254834403697],[ -0.3606630848100153, 0.23248358971682098, -0.5010578544208784, 0.775213008710837],[ 0.14666477762409943, -0.7954994606932673, -0.7828970343839562, -0.27783574531380895],[ -2.2627879492179748, 2.286077929890425, 0.10514921027759709, -2.778175205384904],[ -0.944281004636998, -0.44412343409536803, -0.20667480563614316, -1.324021234321148],[ 1.184372113630197, -1.6061884652707523, 1.2228903547495455, -1.9503199947710714],[ -1.3829153494715043, -1.3140641879188477, -0.626017167674076, -2.26177070134379],[ -2.64173228697919, 2.696929336589955, -0.28239628507575326, -2.069348129917441],[ -0.8012082095518955, 0.8581228615496483, -1.8828970831856415, 6.840185525624577],[ -0.5291377758855058, 0.5791355050052586, -2.215446688259117, 1.9134166705568731],[ -0.32996076893608806, 0.2813351029813089, 2.385819980618468, 1.1312679249883215],[ -1.4824445897447531, -0.04248939309844951, 1.5384997303276515, 1.111926500024418],[ -1.9636704684328359, -0.4548893010380309, -1.0780614206571042, 0.5102155492335327]
]).T
b1= \
    [-0.5737673996751792, -0.08429981063145428, -0.25575264851229956, 0.329521253156993, -1.8384593465970442,
     0.03741003504337764, 1.4091647695667457, -0.4239808773454567, 0.42471613762586446, 1.5715515694102082,
     -0.7935609496250147, -0.5863933262929779, 1.8108579768243613, -0.27348844149515605, -1.3841367472564199,
     -1.5528216809034914, -0.7774539913456738, -0.5674408351185256, -0.44835228437501606, -1.9241576324570562]
expr1 = z * (np.matmul([[x1,x2,x3,x4]],w1)+b1)
#expr1 = -0.0001711589065517019 *pow(expr1,4)+ -0.01447711943585072 *pow(expr1,3)+ 0.002849795794085815 *pow(expr1,2)+ 0.5071116596907747 *expr1+ -0.00508383030596129
# expr1_1 = 0.25 * expr1 * expr1 + 0.001
# expr1 = 0.5 * expr1 + pow(expr1_1,0.5)


w2 =np.array(
    [1.0838171554517642, -0.3934989576353524, 0.012843367240134212, -0.1859482867337161, 0.9637067012610773,
     1.7071970366230502, -0.8513875391016555, -0.5182199097494291, -0.09357554097861812, -0.1793064763884906,
     0.7259041723780834, 0.8146340743256301, -0.882203311667125, -1.059218232868797, 0.7617284884178045,
     -0.7802801374155856, -0.4515347059955696, -0.2806317491658093, -0.40061571682409175, 0.5359906348352135]
).T
b2=   [-0.34239028878514066]

expr2=np.matmul(expr1,w2)+b2
print(expr2)
# expr3 = simplify(expr2)
# print(expr3)