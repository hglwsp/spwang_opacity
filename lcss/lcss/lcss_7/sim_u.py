import numpy as np
import matplotlib.pyplot as plt
import math
import random
#import tensorflow as tf
from sympy import *
import sympy as sp
import torch
import torch.nn as nn

x1 = symbols("x1")  # 符号x，自变量
x2 = symbols("x2")
x3 = symbols("x3")
x4 = symbols("x4")
x5 = symbols("x5")



z = symbols("relu")
z1 = symbols("hardtanh")

# y = 0.792*pow(x1-1,2)#公式
# apart(y,x1)



w1=np.array([
[-0.23423289474224193, -0.361327572049053, -0.6875829337663603, 1.1381807856491366, -1.7968498667346118],[ -1.2341386709349813, 0.7236334227986014, -0.2143312637379391, 0.134562262858832, 2.286686290118771],[ 0.000574987238965933, -0.027927697354006766, -0.00562381260531257, -0.012600761032137375, 1.4993125610976061],[ -0.38154433152480405, 0.6221272210461735, -2.4388472403706936, 0.13826467817901297, -1.4179002182486222],[ -0.996691858482267, -0.3317308904690961, 0.7936952747863726, 0.1883891230526474, -0.6781724530270297],[ 0.023169797649914357, 1.2876943982588662, -1.7888211650202441, -2.2290744387364785, -1.0335786032795256],[ 0.5738038952100469, -0.4172738931719958, 0.5603735233799885, -1.5968463291128812, -0.3184716392259822],[ -0.9625863788178555, -0.4459167525931856, 0.6757729501115336, 0.3237864638643649, 2.3505507369683927]
    ]).T
b1= \
[-0.7196553339888645, 0.32951237251867255, 0.8213764606678642, -0.2603188522097169, -0.5588660182389734, 0.1447591469473593, 0.5068858361593187, 1.8738109669740528]
expr1 = z * (np.matmul([[x1,x2,x3,x4,x5]],w1)+b1)
#expr1 = -0.0001711589065517019 *pow(expr1,4)+ -0.01447711943585072 *pow(expr1,3)+ 0.002849795794085815 *pow(expr1,2)+ 0.5071116596907747 *expr1+ -0.00508383030596129
# expr1_1 = 0.25 * expr1 * expr1 + 0.001
# expr1 = 0.5 * expr1 + pow(expr1_1,0.5)

w2 =np.array(
[-0.003555818477576002, 0.2419016097229219, 0.46733771770018717, 0.8382642482395365, -0.031712015475863935, -0.7558788600247659, -1.5594666399963442, 0.0078083809579084]
).T
b2= [0.09490203612874819]

expr2 =  np.matmul(expr1,w2)+b2
print(expr2)
# expr3 = simplify(expr2)
# print(expr3)